# EvoPlus

## Getting Started
This application uses Maven for build automation as well as Docker for create containers 
and Docker-Compose for container orchestration.

#### Docker
To start the application with Docker, follow these steps:
1) Install dependencies:
`cd app && ./mvnw clean install`

2) Deploy the containers and start the application:
`cd .. && docker-compose up`

3) Navigate to `http://localhost:8080/`

#### Manual startup
To manually start the application (i.e. without Docker) follow these steps:

1) Install dependencies `cd app && ./mvnw clean install`

2) Start the application `./mvnw spring-boot:run`

3) Navigate to `http://localhost:8080/`

## Good to know

### Updating Docker images
Docker keeps copies of previously downloaded images locally and does not update these unless specified.
This can create problems during development.

#### Main application image
If the main application `/app`  is being developed locally, its associated Docker image will need
to be rebuilt everytime the application is run. Otherwise, the newly made changes will not
be reflected when executing the application.

In order to do so, execute this command before deploying the containers:
`docker-compose build`


#### Other images
Publicly available images can be updated with the following command:
`docker-compose pull`

## Test Code Coverage with JaCoCo (Java Code Coverage)

We have included the JaCoCO tool in the Evo+ project. JaCoCo is an open-source code coverage tool used to measure and report how much of your Java code is executed during the execution of Junit tests. The report generated by JaCoCO will be used to verify the coverage of the tests implemented for the classes in the service and controller packages. The test coverage report is generated automatically during the Evo+ build. To access the report, navigate to the following folder: `../app/target/site/jacoco/index.html`

#### How to reading the reporting information

JaCoCo report helps us visually analyze code coverage by using diamonds with colors for branches and background colors for lines:
- **Red diamond** means that no branches have been tested during the test phase.
- **Yellow diamond** shows that the code is partially covered – some branches have not been tested.
- **Green diamond** means that all branches have been tested during the test.

**The same color codes (Red, Yellow, and Green used in the diamonds) are applied to the background color but for line coverage.**

Also, JaCoCo mainly provides three essential metrics:
- **Lines coverage** reflects the amount of code tested based on the number of Java byte code instructions called by the tests.
- **Branches coverage** shows the percent of tested branches in the code, typically related to if/else and switch statements.
- **Cyclomatic complexity** reflects the complexity of code by giving the number of paths needed to cover all the possible paths in a code through linear combination.

**More information can be find at: https://www.jacoco.org/jacoco/**

## Evo+ Project Reports
The Evo+ Project Report was developed using Maven reports to provide an overview and detailed documentation of the project's current state. It includes:
* Project Dependencies: The list of compiled dependencies for the Evo+ project.
* Plugins: The list of plugins used in the project.
* Quality Reports.
    * Checkstyle: Report on coding style conventions.
    * JaCoCo: Test Report coverage.
    * Surefire: Report on the test results of the project.

Steps to generate the report:
1) Run `./mvnw clean install` to build the application.
2) Use `./mvnw site` to generate the report.
3) Access the report at `./app/target/site/index.html`.

## POSTMAN collection testing
Postman is a tool used to test the API of this project. A collection of CRUD requests for the entities is included in the /doc folder.
This collection can be imported in Postman, and each request can then be run sequentially, acting as a suite of tests.

```./doc/EvoCollection.postman_collection.json```

If the collection needs to be changed, a new updated collection should be exported from Postman to this project.

These requests provide a measure of functional as well as end-to-end testing for the evo+ project.


## Evo+ physical database model

The physical database model for Evo+ can be found in the folder: `../doc/evo_db model.png`

**Note: This model needs to be updated with each database change.**


## Evo+ POC data loading
Before running the Evo+ in the POC test, executing the following steps to loading the data: 

1) Drop all tables in the database schema if it exists.
2) Build the application with `./mvnw clean install`.
3) Rename the `../app/src/main/resources/mdata.txt` file to `data.sql`.
4) Run it with `./mvnw spring-boot:run`.
5) Navigate to `http://localhost:8080/actor/find/1`.
6) After the data is loaded, rename the `data.sql` file to `mdata.txt`.

`Notes:
- You can run the script right in your database. Just rename the file to data.sql. Then, open and run the script using your database tool.
- You can run the script right in IntelliJ if you want.`