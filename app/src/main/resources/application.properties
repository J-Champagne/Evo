######################################################################################
##                    EVO PLUS APPLICATION CONFIGURATION                            ##
######################################################################################
spring.application.name=Evo+
spring.banner.location=classpath:/banner.txt
spring.main.banner-mode=console

######################################################################################
####                   EVO PLUS APPLICATION TESTING CONFIGURATION                 ####
evo.data.loader.data.location=../POC/data.sql
evo.data.postgres.docker.image.name=postgres:17.2

######################################################################################
##                              Log Configuration                                   ##
######################################################################################
logging.level.org.springframework=INFO
logging.level.org.springframework.web=ERROR
logging.level.org.hibernate=ERROR
logging.level.root=ERROR
logging.level.ca.uqam.latece.evo.server.core=DEBUG
logging.file.name=evoplus.log


######################################################################################
##                      PostgreSQL Connection Configuration                         ##
######################################################################################
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.url=jdbc:postgresql://localhost:5432/evo_db
spring.datasource.username=evo
spring.datasource.password=123

##                        HikariCP connection pool configuration                    ##
######################################################################################
## Set the maximum number of milliseconds that a client will wait for a connection from the pool. If this time is
## exceeded without a connection becoming available, a SQLException will be thrown from javax.sql.DataSource.getConnection().
spring.datasource.hikari.connection-timeout=30000

## The property controls the maximum size that the pool is allowed to reach, including both idle and in-use connections.
## Basically, this value will determine the maximum number of actual connections to the database backend. When the pool
## reaches this size, and no idle connections are available, calls to getConnection() will block for up to
## connectionTimeout milliseconds before timing out
spring.datasource.hikari.maximum-pool-size=10

## The property controls the minimum number of idle connections that HikariCP tries to maintain in the pool, including
## both idle and in-use connections. If the idle connections dip below this value, HikariCP will make a best effort to
## restore them quickly and efficiently.
spring.datasource.hikari.minimum-idle=2

## This property controls the maximum amount of time (in milliseconds) that a connection is allowed to sit idle in the
## pool. Whether a connection is retired as idle or not is subject to a maximum variation of +30 seconds, and an average
## variation of +15 seconds. A connection will never be retired as idle before this timeout. A value of 0 means that idle
## connections are never removed from the pool.
spring.datasource.hikari.idle-timeout=600000

## This property controls the maximum lifetime of a connection in the pool. When a connection reaches this timeout, even
## if recently used, it will be retired from the pool. An in-use connection will never be retired, only when it is idle
## will it be removed.
spring.datasource.hikari.max-lifetime=1800000

## This property controls the amount of time that a connection can be out of the pool before a message is logged indicating
## a possible connection leak. A value of 0 means leak detection is disabled.
spring.datasource.hikari.leak-detection-threshold=3000

## Sets the name of the connection pool. This is primarily used in logging and JMX management consoles to identify pools
## and pool configurations.
spring.datasource.hikari.pool-name=EvoHikariPool


spring.sql.init.mode=always
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

######################################################################################
####                               ONLY FOR TESTING                               ####
### Warning: Never use the spring.jpa.hibernate.ddl-auto property in production, as it
### means that Hibernate will automatically create tables and update the schema as
### necessary based on the application's entity classes. In other words, any changes to
### the Entity classes will be reflected in the database and could introduce errors or
### break the consistency of the database schema. When using this property in development
### and testing environments, make sure that the schema generated by it is correct with
### the modeled database schema.

## This property sets the strategy used by Hibernate to drop existing tables and then creates new tables.
# spring.jpa.hibernate.ddl-auto=create

## This property sets the strategy used by Hibernate to generate and update the database schema.
# spring.jpa.hibernate.ddl-auto=create-drop

## Sets this property means that Hibernate will automatically create tables and update the schema as needed based on the
## entity classes in the application.
#spring.jpa.hibernate.ddl-auto=update

## This property sets the strategy used by Hibernate to validate whether the tables and columns exist.
## Otherwise, it throws an exception.
# spring.jpa.hibernate.ddl-auto=validate

## This property sets the strategy used by Hibernate to turn off the DDL generation.
 spring.jpa.hibernate.ddl-auto=none

######################################################################################
####                               ONLY FOR TESTING                               ####
## Only for testing, production set to none or comment it.
## Enable query logging.
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.show_sql=true
spring.jpa.properties.hibernate.use_sql_comments=true
spring.jpa.properties.hibernate.generate_statistics=true

## This property is used to declare a global policy for lazy-loaded object fetching. Setting it by true means that each
# access to an associated lazy-loaded entity will be wrapped in a new session running in a new transaction.
# REMARKS:
# - NOTE THAT THIS PROPERTY ISN'T RECOMMENDED SINCE IT'LL SLOW DOWN THE PERFORMANCE OF THE APPLICATION. ALSO, IT ISN'T
# EFFICIENT AND IS ALSO CONSIDERED AN ANTIPATTERN.
# - DO NOT USE THIS PROPERTY AS A DEFINITIVE SOLUTION TO THE LAZY-LOADED ENTITY ISSUE. INSTEAD, IDENTIFY THE ENTITIES
# THAT REQUIRE FetchType.EAGER INSTEAD OF FetchType.LAZY. ONCE IDENTIFIED, MAKE THE NECESSARY CHANGES. REVIEW AND UPDATE
# EXISTING TESTS TO CONFIRM THAT SYSTEM BEHAVIOR REMAINS CORRECT.
spring.jpa.properties.hibernate.enable_lazy_load_no_trans=true
# spring.jpa.properties.hibernate.enable_lazy_load_no_trans=false